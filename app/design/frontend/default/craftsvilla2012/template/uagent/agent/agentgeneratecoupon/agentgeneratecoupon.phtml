<?php
    $_session = Mage::getSingleton('uagent/session');
    if ($_session->isLoggedIn()): //echo "<pre>"; print_r($_session->getVendor());
?>
<div class="uagent_box_desc"><div>Here you can generate referral coupon codes to distrubute them to the customers. You can float <a href="http://craftsvilla.com/" target="_blank">craftsvilla.com</a> coupon generated by you on various portals, coupon sites or your local network of friends and family. If customer uses that coupon, we know that customer came from you. We then deduct that coupon % from 10% and deposit rest to you. You can generate coupon upto 10% from your agent panel. Please note if you generate 7% coupon and a customer uses that coupon, you get paid only 3% commission.<br>
  <br>
</div>
Some of the well known coupon sites are listed below for your reference:<br>
1. <a href="http://www.indiancoupons.com/" target="_blank">http://www.indiancoupons.com/</a>
<div>2. <a href="http://www.desidime.com/coupons/craftsvilla-coupons" target="_blank">http://www.desidime.com/coupons/craftsvilla-coupons</a></div>
<div>3. <a href="http://www.couponrani.com/craftsvilla-com" target="_blank">http://www.couponrani.com/craftsvilla-com</a></div>
<div>4. <a href="http://www.couponraja.com/craftsvilla.html" target="_blank">http://www.couponraja.com/craftsvilla.html</a></div>
<div>5. <a href="http://www.retailmenot.com/view/craftsvilla.com" target="_blank">http://www.retailmenot.com/view/craftsvilla.com</a></div>
<div>6. <a href="http://www.yebhioffers.com/" target="_blank">www.yebhioffers.com</a></div>
<div>7. <a href="http://cashkaro.com/stores/craftsvilla" target="_blank">http://cashkaro.com/stores/craftsvilla</a></div>
<div>8. <a href="http://www.mycouponcodesindia.com/" target="_blank">http://www.mycouponcodesindia.com</a></div>
<div>9. <a href="http://www.dshopping.in/" target="_blank">http://www.dshopping.in/</a></div>
<div>10. <a href="http://freekaamaal.com/coupons/craftsvilla.com/" target="_blank">http://freekaamaal.com/coupons/craftsvilla.com/</a></div>
<div>11. <a href="http://freekaamaalhai.com/" target="_blank">http://freekaamaalhai.com/</a></div>
<div>12. <a href="http://www.coupondunia.in/craftsvilla" target="_blank">http://www.coupondunia.in/craftsvilla</a></div>
<div>13. <a href="http://khojguru.com/craftsvilla-coupons-codes_b_2npub" target="_blank">http://khojguru.com/craftsvilla-coupons-codes_b_2npub</a></div>
<div>14. <a href="http://www.dealskhoj.in/coupons/craftsvilla" target="_blank">http://www.dealskhoj.in/coupons/craftsvilla</a><br>
  15. <a href="http://www.coupons.in/Craftsvilla.com/" target="_blank">http://www.coupons.in/Craftsvilla.com/</a></div>
 </div>
<div class="page-title">
        <h1>Generate Coupon</h1>
    </div>
<?php echo $this->getMessagesBlock()->getGroupedHtml() ?>

	<table cellspacing="1" cellpadding="0" class="data-table table-gride vtop">
        <thead>
            <tr>
                <th><?php echo $this->__('Rule Name')?></th>
                <th><?php echo $this->__('From Date')?></th>
                <th><?php echo $this->__('To Date')?></th>
                <th><?php echo $this->__('Click the button') ?></th>
            </tr>
        </thead>
      <tbody>
            <tr>
                <form name="coupongenerate" action="<?php echo $this->getUrl('uagent/index/generatecouponblock');?>" method="post">
                    <td ><?php echo $this->__('<b>FLAT:-</b><input type="text" name = "percentage" id "percentage" class="input-text" style="width:20px !important;" value=""><b>% OFF Over All Products</b>');?></td>
                    <td><input type="text" name="from_date" id="from_date" class="input-text" style="width:85px !important;" value="" />
        	<img src="<?php echo $this->getUrl();?>/skin/adminhtml/default/default/images/grid-cal.gif" alt="" class="v-middle" id="from_date_trig" title="Select Date" style="">
				<script type="text/javascript">
                //<![CDATA[
                    Calendar.setup({
                        inputField: "from_date",
                        ifFormat: "%m/%e/%y",
                        showsTime: false,
                        button: "from_date_trig",
                        align: "Bl",
                        singleClick : true
                    });
                //]]>
                </script></td>
                    <td><input type="text" name="to_date" id="to_date" class="input-text" style="width:85px !important;" value="" />
        		<img src="<?php echo $this->getUrl();?>/skin/adminhtml/default/default/images/grid-cal.gif" alt="" class="v-middle" id="to_date_trig" title="Select Date" style="">
				<script type="text/javascript">
                //<![CDATA[
                    Calendar.setup({
                        inputField: "to_date",
                        ifFormat: "%m/%e/%y",
                        showsTime: false,
                        button: "to_date_trig",
                        align: "Bl",
                        singleClick : true
                    });
                //]]>
                </script></td>
                    <td> 
                    <input type="hidden" name="agent_id" value="<?php echo $_session->getAgent()->getAgentId();?>"  />
                    <input type="submit" value="Generate Coupon" class="form-button"/>
                    </td>
                </form>
            </tr> 
            
            <!--2nd row for rule-->
            <!--<tr>
                <form name="coupongenerate2" action="<?php //echo $this->getUrl('uagent/index/generatecouponfixedcart');?>" method="post">
                    <td><?php //echo $this->__('<b>Rs.</b><input type="text" name = "rupees" id "rupees" class="input-text" style="width:30px !important;" value="">/- <B>Off If Order is greater than Rs.</b><input type="text" name = "rupees1" id "rupees1" class="input-text" style="width:50px !important;" value="">');?></td>
                    <td><input type="text" name="from_date1" id="from_date1" class="input-text" style="width:85px !important;" value="" />
        	<img src="<?php //echo $this->getUrl();?>/skin/adminhtml/default/default/images/grid-cal.gif" alt="" class="v-middle" id="from_date_trig1" title="Select Date" style="">
				<script type="text/javascript">
                //<![CDATA[
                    Calendar.setup({
                        inputField: "from_date1",
                        ifFormat: "%m/%e/%y",
                        showsTime: false,
                        button: "from_date_trig1",
                        align: "Bl",
                        singleClick : true
                    });
                //]]>
                </script></td>
                    <td><input type="text" name="to_date1" id="to_date1" class="input-text" style="width:85px !important;" value="" />
        		<img src="<?php //echo $this->getUrl();?>/skin/adminhtml/default/default/images/grid-cal.gif" alt="" class="v-middle" id="to_date_trig1" title="Select Date" style="">
				<script type="text/javascript">
                //<![CDATA[
                    Calendar.setup({
                        inputField: "to_date1",
                        ifFormat: "%m/%e/%y",
                        showsTime: false,
                        button: "to_date_trig1",
                        align: "Bl",
                        singleClick : true
                    });
                //]]>
                </script></td>
                    <td> 
                    <input type="hidden" name="agent_id" value="<?php //echo $_session->getAgent()->getAgentId();?>"  />
                    <input type="submit" value="Generate Coupon" class="form-button"/>
                    
                    </td>
                </form>
            </tr>-->
            <!--3rd row for rule-->
            <tr>
                <form name="coupongenerate3" action="<?php echo $this->getUrl('uagent/index/generatecouponpercentage');?>" method="post">
                    <td><?php echo $this->__('<input type="text" name = "rupeepercent" id "rupeepercent" class="input-text" style="width:20px !important;" value=""><b>% Off If order is greater than rupees Rs.</b><input type="text" name = "rupeepercent1" id "rupeepercent1" class="input-text" style="width:40px !important;" value="">');?></td>
                    <td><input type="text" name="from_date2" id="from_date2" class="input-text" style="width:85px !important;" value="" />
        	<img src="<?php echo $this->getUrl();?>/skin/adminhtml/default/default/images/grid-cal.gif" alt="" class="v-middle" id="from_date_trig2" title="Select Date" style="">
				<script type="text/javascript">
                //<![CDATA[
                    Calendar.setup({
                        inputField: "from_date2",
                        ifFormat: "%m/%e/%y",
                        showsTime: false,
                        button: "from_date_trig2",
                        align: "Bl",
                        singleClick : true
                    });
                //]]>
                </script></td>
                    <td><input type="text" name="to_date2" id="to_date2" class="input-text" style="width:85px !important;" value="" />
        		<img src="<?php echo $this->getUrl();?>/skin/adminhtml/default/default/images/grid-cal.gif" alt="" class="v-middle" id="to_date_trig2" title="Select Date" style="">
				<script type="text/javascript">
                //<![CDATA[
                    Calendar.setup({
                        inputField: "to_date2",
                        ifFormat: "%m/%e/%y",
                        showsTime: false,
                        button: "to_date_trig2",
                        align: "Bl",
                        singleClick : true
                    });
                //]]>
                </script></td>
                    <td> 
                    <input type="hidden" name="agent_id" value="<?php echo $_session->getAgent()->getAgentId();?>"  />
                    <input type="submit" value="Generate Coupon" class="form-button"/>
                    
                    </td>
                </form>
            </tr>
	  </tbody>
    </table>
    <br /><br /><br /><br /><br /><br />

    <div class="box-head">
  <h3>Details Of Your Coupon Created</h3>
</div>
<div class="a-left" style="margin:10px 0">

<div style="max-height: 1000px;overflow: scroll;width: 883px;">    
    <table cellspacing="1" cellpadding="0" class="data-table table-gride vtop">
     <thead>
        <tr>
          <th><?php echo $this->__('Name')?></th>
          <th><?php echo $this->__('Coupon Code')?></th>
          <th><?php echo $this->__('From Date')?></th>
          <th><?php echo $this->__('End Date')?></th>
          <th>Change Status</th>
         </tr>
      </thead>
      <tbody>
      	<?php
		$agentId = Mage::getSingleton('uagent/session')->getAgentId();
		$rulesCollection = Mage::getModel('salesrule/rule')->getCollection()
				->addFieldToFilter('agentid', $agentId)
				->setOrder('rule_id','DESC');
		
		foreach ($rulesCollection as $collect) 
		{
			if($collect->getAgentid()!= '')
			{
		?>	
		<tr>
          <td><?php echo $collect->getDescription();?></td>
          <td><?php echo $collect->getCode();?></td>
          <td><?php echo $collect->getFromDate();?></td>
          <td><?php echo $collect->getToDate();?></td>
          <?php if($collect->getIsActive() == '0') {?>
          <td class="generatecoupon">
              <input type="hidden" name ="generatecoupon" value="<?php echo $collect->getRuleId();?>" />
              <input disabled="disabled" type="submit" id="inactive" value="DEACTIVATED" class="bluebtnsmall" /> 
          </td>
          <?php } else {?>
          
          <td class="generatecoupon">
          	  <form method="post" action="<?php echo $this->getUrl('uagent/index/agentgeneratecoupon') ?>">  
              <input type="hidden" name ="generatecoupon" value="<?php echo $collect->getRuleId();?>" />
              <input name="inactive" type="submit" id="inactive" value="DeActivate" class="form-button" /> 
          </form> 
          </td><?php }
		  }
		  
		  } ?>
           
        </tr> 
      </tbody>
    </table>
    
    <div class="clr"></div>
</div>

<?php endif;?>
<script type="text/javascript">
//<![CDATA[
enUS = {"m":{"wide":["January","February","March","April","May","June","July","August","September","October","November","December"],"abbr":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}}; // en_US locale reference
Calendar._DN = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]; // full day names
Calendar._SDN = ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]; // short day names
Calendar._FD = 0; // First day of the week. "0" means display Sunday first, "1" means display Monday first, etc.
Calendar._MN = ["January","February","March","April","May","June","July","August","September","October","November","December"]; // full month names
Calendar._SMN = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]; // short month names
Calendar._am = "AM"; // am/pm
Calendar._pm = "PM";

// tooltips
Calendar._TT = {};
Calendar._TT["INFO"] = "About the calendar";

Calendar._TT["ABOUT"] =
"DHTML Date/Time Selector\n" +
"(c) dynarch.com 2002-2005 / Author: Mihai Bazon\n" +
"For latest version visit: http://www.dynarch.com/projects/calendar/\n" +
"Distributed under GNU LGPL. See http://gnu.org/licenses/lgpl.html for details." +
"\n\n" +
"Date selection:\n" +
"- Use the \xab, \xbb buttons to select year\n" +
"- Use the " + String.fromCharCode(0x2039) + ", " + String.fromCharCode(0x203a) + " buttons to select month\n" +
"- Hold mouse button on any of the above buttons for faster selection.";
Calendar._TT["ABOUT_TIME"] = "\n\n" +
"Time selection:\n" +
"- Click on any of the time parts to increase it\n" +
"- or Shift-click to decrease it\n" +
"- or click and drag for faster selection.";

Calendar._TT["PREV_YEAR"] = "Prev. year (hold for menu)";
Calendar._TT["PREV_MONTH"] = "Prev. month (hold for menu)";
Calendar._TT["GO_TODAY"] = "Go Today";
Calendar._TT["NEXT_MONTH"] = "Next month (hold for menu)";
Calendar._TT["NEXT_YEAR"] = "Next year (hold for menu)";
Calendar._TT["SEL_DATE"] = "Select date";
Calendar._TT["DRAG_TO_MOVE"] = "Drag to move";
Calendar._TT["PART_TODAY"] = ' (' + "Today" + ')';

// the following is to inform that "%s" is to be the first day of week
Calendar._TT["DAY_FIRST"] = "Display %s first";

// This may be locale-dependent. It specifies the week-end days, as an array
// of comma-separated numbers. The numbers are from 0 to 6: 0 means Sunday, 1
// means Monday, etc.
Calendar._TT["WEEKEND"] = "0,6";

Calendar._TT["CLOSE"] = "Close";
Calendar._TT["TODAY"] = "Today";
Calendar._TT["TIME_PART"] = "(Shift-)Click or drag to change value";

// date formats
Calendar._TT["DEF_DATE_FORMAT"] = "%b %e, %Y";
Calendar._TT["TT_DATE_FORMAT"] = "%B %e, %Y";

Calendar._TT["WK"] = "Week";
Calendar._TT["TIME"] = "Time:";

//]]>

</script>
